//
//  LunarService.swift
//  ThreeDays
//
//  Created by koen.chen on 2021/7/5.
//

import Foundation

class LunarService {
    static func getLunarSpecialDate(iYear: Int, iMonth: Int, iDay: Int) -> String? {
        guard iYear >= 2020, (1...12).contains(iMonth), (1...31).contains(iDay) else {
            return ""
        }
        
        let chineseDays = [
            "小寒","大寒","立春","雨水","惊蛰","春分",
            
            "清明","谷雨","立夏","小满","芒种","夏至",
            
            "小暑","大暑","立秋","处暑","白露","秋分",
            
            "寒露","霜降","立冬","小雪","大雪","冬至"
        ]
        
        let array_index = (iYear - START_YEAR) * 12 + iMonth - 1
        
        let flag = gLunarHolDay[array_index]
        var day = 0
        
        if iDay < 15 {
            day = 15 - ((flag >> 4) & 0x0f)
        } else {
            day = ((flag) & 0x0f) + 15
        }
        var index = -1
        if iDay == day {
            index = (iMonth-1) * 2 + (iDay > 15 ? 1: 0);
        }
        
        if index >= 0 && index < chineseDays.count {
            return chineseDays[index]
        }
        
        return nil
    }
    
    
    public static let START_YEAR = 2020
    public static let END_YEAR = 2050
    
    public static let  gLunarHolDay = [
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x86,  //2020
        
        0xA5,0xC3, 0xA5,0xB5, 0xA6,0xA6, 0x87,0x88, 0x88,0x78, 0x87,0x86,  //2021
        
        0xA5,0xB4, 0xA5,0xA5, 0xA6,0x96, 0x88,0x88, 0x88,0x78, 0x87,0x87,  //2022
        
        0xA5,0xB4, 0x96,0xA5, 0x96,0x96, 0x88,0x78, 0x78,0x79, 0x77,0x87,  //2023
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x96,  //2024
        
        0xA5,0xC3, 0xA5,0xB5, 0xA6,0xA6, 0x87,0x88, 0x88,0x78, 0x87,0x86,  //2025
        
        0xA5,0xB3, 0xA5,0xA5, 0xA6,0xA6, 0x88,0x88, 0x88,0x78, 0x87,0x87,  //2026
        
        0xA5,0xB4, 0x96,0xA5, 0x96,0x96, 0x88,0x78, 0x78,0x78, 0x87,0x87,  //2027
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x96,  //2028
        
        0xA5,0xC3, 0xA5,0xB5, 0xA6,0xA6, 0x87,0x88, 0x88,0x78, 0x87,0x86,  //2029
        
        0xA5,0xB3, 0xA5,0xA5, 0xA6,0xA6, 0x88,0x88, 0x88,0x78, 0x87,0x87,  //2030
        
        0xA5,0xB4, 0x96,0xA5, 0x96,0x96, 0x88,0x78, 0x78,0x78, 0x87,0x87,  //2031
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x96,  //2032
        
        0xA5,0xC3, 0xA5,0xB5, 0xA6,0xA6, 0x88,0x88, 0x88,0x78, 0x87,0x86,  //2033
        
        0xA5,0xB3, 0xA5,0xA5, 0xA6,0xA6, 0x88,0x78, 0x88,0x78, 0x87,0x87,  //2034
        
        0xA5,0xB4, 0x96,0xA5, 0xA6,0x96, 0x88,0x88, 0x78,0x78, 0x87,0x87,  //2035
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x96,  //2036
        
        0xA5,0xC3, 0xA5,0xB5, 0xA6,0xA6, 0x87,0x88, 0x88,0x78, 0x87,0x86,  //2037
        
        0xA5,0xB3, 0xA5,0xA5, 0xA6,0xA6, 0x88,0x88, 0x88,0x78, 0x87,0x87,  //2038
        
        0xA5,0xB4, 0x96,0xA5, 0xA6,0x96, 0x88,0x88, 0x78,0x78, 0x87,0x87,  //2039
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x96,  //2040
        
        0xA5,0xC3, 0xA5,0xB5, 0xA5,0xA6, 0x87,0x88, 0x87,0x78, 0x87,0x86,  //2041
        
        0xA5,0xB3, 0xA5,0xB5, 0xA6,0xA6, 0x88,0x88, 0x88,0x78, 0x87,0x87,  //2042
        
        0xA5,0xB4, 0x96,0xA5, 0xA6,0x96, 0x88,0x88, 0x78,0x78, 0x87,0x87,  //2043
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA6, 0x97,0x87, 0x87,0x88, 0x87,0x96,  //2044
        
        0xA5,0xC3, 0xA5,0xB4, 0xA5,0xA6, 0x87,0x88, 0x87,0x78, 0x87,0x86,  //2045
        
        0xA5,0xB3, 0xA5,0xB5, 0xA6,0xA6, 0x87,0x88, 0x88,0x78, 0x87,0x87,  //2046
        
        0xA5,0xB4, 0x96,0xA5, 0xA6,0x96, 0x88,0x88, 0x78,0x78, 0x87,0x87,  //2047
        
        0x95,0xB4, 0xA5,0xB4, 0xA5,0xA5, 0x97,0x87, 0x87,0x88, 0x86,0x96,  //2048
        
        0xA4,0xC3, 0xA5,0xA5, 0xA5,0xA6, 0x97,0x87, 0x87,0x78, 0x87,0x86,  //2049
        
        0xA5,0xC3, 0xA5,0xB5, 0xA6,0xA6, 0x87,0x88, 0x78,0x78, 0x87,0x87    //2050
    ]
}
